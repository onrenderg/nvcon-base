<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="NICVC.ScheduleVcDetailsPage" 
             xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls" 
             ios:Page.UseSafeArea="true">
    <NavigationPage.TitleView>
        <HorizontalStackLayout x:Name="Custom_Navigation" HorizontalOptions="Fill" VerticalOptions="Center" Spacing="10">
            <Image Source="ic_launcher.png" HeightRequest="40" VerticalOptions="Center"/>
            <Label x:Name="Lbl_Header" 
                   Text="NIC Video Conferencing" 
                   Style="{StaticResource NavigationLabelColor}" 
                   FontSize="18" 
                   FontAttributes="Bold" 
                   HorizontalTextAlignment="Center" 
                   VerticalTextAlignment="Center" 
                   HorizontalOptions="Center"/>
        </HorizontalStackLayout>
    </NavigationPage.TitleView>
    <ContentPage.ToolbarItems>
        <ToolbarItem IconImageSource="ic_home.png" Clicked="ToolbarItem_Clicked" />
    </ContentPage.ToolbarItems>
    <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto,*">
        <Label x:Name="lbl_user_header1" 
               Grid.Row="0" 
               Padding="3" 
               FontSize="18" 
               HorizontalTextAlignment="Center" 
               VerticalTextAlignment="Center" 
               Margin="2,2,2,0" 
               FontAttributes="Bold" 
               TextColor="White" 
               BackgroundColor="Navy"/>
        
        <Label x:Name="lbl_user_header" 
               Grid.Row="1" 
               Padding="3" 
               FontSize="18" 
               HorizontalTextAlignment="Center" 
               VerticalTextAlignment="Center" 
               Margin="2" 
               FontAttributes="Bold" 
               TextColor="White" 
               BackgroundColor="Navy"/>

        <!-- Time Filter -->
        <Grid Grid.Row="2" 
              Margin="5,0,5,0" 
              ColumnDefinitions="Auto,*">
            <Label x:Name="lbl_startingtime" 
                   Text="Select Starting Time" 
                   VerticalTextAlignment="Center" 
             
                   FontAttributes="Bold" 
                   Grid.Column="0"/>
            <Picker x:Name="picker_sort" 
                    Title="Select Starting Time" 
         
                    HorizontalOptions="Fill" 
                    Grid.Column="1" 
                    SelectedIndexChanged="picker_sort_SelectedIndexChanged" 
                    ios:Picker.UpdateMode="WhenFinished"/>
        </Grid>

        <Border Grid.Row="3" 
                BackgroundColor="White" 
                Padding="0" 
                Margin="3" 
                Stroke="Navy" 
                StrokeThickness="1"
                StrokeShape="RoundRectangle 20">
            <SearchBar x:Name="searchbar_schedulevcdetails" 
                       Placeholder="Search" 
                       PlaceholderColor="Maroon" 
                       TextChanged="searchbar_schedulevcdetails_TextChanged" 
                       CancelButtonColor="Red" 
                       TextColor="Navy"/>
        </Border>
        
        <Label x:Name="lbl_search" 
               Grid.Row="4" 
               FontSize="Default" 
               HorizontalOptions="Center" 
               HorizontalTextAlignment="Center" 
               VerticalTextAlignment="Start" 
               FontAttributes="Bold" 
      
               Text="Type In Search Bar To Filter Results In Realtime"/>

        <Grid Grid.Row="5" Margin="9">
            <CollectionView x:Name="listView_schedulevcdetails" SelectionMode="None" IsVisible="false">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="0,0,0,10" BackgroundColor="White" Stroke="Navy" StrokeThickness="2">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="20"/>
                            </Border.StrokeShape>
                            <Grid Padding="10">
                                <VerticalStackLayout Spacing="8">
                                    <!-- VC ID Header -->
                                    <HorizontalStackLayout Spacing="5" HorizontalOptions="Center">
                                        <Label Text="VC ID: " TextColor="OrangeRed" FontSize="18" FontAttributes="Bold" TextDecorations="Underline"/>
                                        <Label Text="{Binding VC_ID}" TextColor="OrangeRed" FontSize="18" FontAttributes="Bold" TextDecorations="Underline"/>
                                    </HorizontalStackLayout>

                                    <!-- Start Time -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Start Time" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Startingtime}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- End Time -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="End Time" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VCEndTime}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Level -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Level" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding LevelName}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Organisation -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Organisation" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Org_Name}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Department -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Department" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Dept_Name}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Purpose -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Purpose" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Purpose}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Studio Name -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Studio Name" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Studio_Name}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Host Studio -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Host Studio" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding hoststudio}" TextColor="Red" FontSize="14" FontAttributes="Bold" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Requested By -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Requested By" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding RequestedBy}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Coordinator Name -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Coordinator Name" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordName}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Coordinator Mobile -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Coordinator Mobile" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordMobile}" TextColor="Blue" FontSize="14" Margin="3,0,0,0" TextDecorations="Underline">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer Tapped="TapGestureRecognizer_Tapped" NumberOfTapsRequired="1"/>
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </VerticalStackLayout>

                                    <!-- Coordinator Email -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Coordinator Email" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordEmail}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- IP Phone -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="IP Phone" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordIpPhone}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Landline -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Landline" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VccoordLandline}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Webroom -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="Webroom" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding webroom}" TextColor="OrangeRed" FontSize="14" FontAttributes="Bold" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Action Buttons -->
                                    <HorizontalStackLayout Spacing="10" Margin="0,10,0,0" HorizontalOptions="Center">
                                        <Button CornerRadius="20" CommandParameter="{Binding VC_ID}" Clicked="btn_takemethere_Clicked" FontSize="16" BackgroundColor="Transparent" BorderColor="Navy" BorderWidth="1" TextColor="Navy" IsVisible="{Binding takemetherevisibility}" Text="📍 Take Me There" FontAttributes="Bold"/>
                                        <Button CornerRadius="20" CommandParameter="{Binding VC_ID}" Clicked="btn_alertme_Clicked" FontSize="16" BackgroundColor="Transparent" BorderColor="Navy" BorderWidth="1" TextColor="Navy" FontAttributes="Bold" IsVisible="{Binding alertmevisibility}" Text="⏰ Alert"/>
                                    </HorizontalStackLayout>

                                </VerticalStackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <CollectionView x:Name="listView_schedulevcdetailslocal" SelectionMode="None" IsVisible="false">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="0,0,0,10" BackgroundColor="White" Stroke="Navy" StrokeThickness="2">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="20"/>
                            </Border.StrokeShape>
                            <Grid Padding="10">
                                <VerticalStackLayout Spacing="8">
                                    <!-- VC ID Header -->
                                    <HorizontalStackLayout Spacing="5" HorizontalOptions="Center">
                                        <Label Text="वीसी आईडी: " TextColor="OrangeRed" FontSize="18" FontAttributes="Bold" TextDecorations="Underline"/>
                                        <Label Text="{Binding VC_ID}" TextColor="OrangeRed" FontSize="18" FontAttributes="Bold" TextDecorations="Underline"/>
                                    </HorizontalStackLayout>

                                    <!-- समय शुरू -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="समय शुरू" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Startingtime}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- समाप्त समय -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="समाप्त समय" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VCEndTime}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- स्तर -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="स्तर" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding LevelName}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- संगठन -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="संगठन" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Org_Name}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- विभाग -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="विभाग" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Dept_Name}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- उद्देश्य -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="उद्देश्य" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Purpose}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- स्टूडियो नाम -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="स्टूडियो नाम" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding Studio_Name}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- होस्ट स्टूडियो -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="होस्ट स्टूडियो" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding hoststudio}" TextColor="Red" FontSize="14" FontAttributes="Bold" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- द्वारा अनुरोध किया गया -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="द्वारा अनुरोध किया गया" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding RequestedBy}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- समन्वयक का नाम -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="समन्वयक का नाम" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordName}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- समन्वयक का मोबाइल -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="समन्वयक का मोबाइल" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordMobile}" TextColor="Blue" FontSize="14" Margin="3,0,0,0" TextDecorations="Underline">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer Tapped="TapGestureRecognizer_Tapped" NumberOfTapsRequired="1"/>
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </VerticalStackLayout>

                                    <!-- समन्वयक का ईमेल -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="समन्वयक का ईमेल" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordEmail}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- आईपी फोन -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="आईपी फोन" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VcCoordIpPhone}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- लैंडलाइन -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="लैंडलाइन" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding VccoordLandline}" TextColor="Maroon" FontSize="14" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- वेब रूम -->
                                    <VerticalStackLayout Spacing="2">
                                        <Label Text="वेब रूम" TextColor="Navy" FontAttributes="Bold" FontSize="14"/>
                                        <Label Text="{Binding webroom}" TextColor="OrangeRed" FontSize="14" FontAttributes="Bold" Margin="3,0,0,0"/>
                                    </VerticalStackLayout>

                                    <!-- Action Buttons -->
                                    <HorizontalStackLayout Spacing="10" Margin="0,10,0,0" HorizontalOptions="Center">
                                        <Button CornerRadius="20" CommandParameter="{Binding VC_ID}" Clicked="btn_takemethere_Clicked" FontSize="16" BackgroundColor="Transparent" BorderColor="Navy" BorderWidth="1" TextColor="Navy" IsVisible="{Binding takemetherevisibility}" Text="📍 मुझे वहां ले चलो" FontAttributes="Bold"/>
                                        <Button CornerRadius="20" CommandParameter="{Binding VC_ID}" Clicked="btn_alertme_Clicked" FontSize="16" BackgroundColor="Transparent" BorderColor="Navy" BorderWidth="1" TextColor="Navy" FontAttributes="Bold" IsVisible="{Binding alertmevisibility}" Text="⏰ सचेत करें"/>
                                    </HorizontalStackLayout>

                                </VerticalStackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>

        <!-- Loading Overlay -->
        <Grid Grid.Row="0" 
              Grid.RowSpan="6"
              x:Name="Loading_activity" 
              BackgroundColor="#C0808080" 
              IsVisible="false"
              Padding="20">
            <Border BackgroundColor="White" 
                    VerticalOptions="Center" 
                    HorizontalOptions="Center" 
                    Padding="20" 
                    StrokeThickness="0"
                    StrokeShape="RoundRectangle 10">
                <HorizontalStackLayout Spacing="15">
                    <ActivityIndicator IsVisible="true" IsRunning="true" Color="Navy"/>
                    <Label x:Name="Lbl_PleaseWait" 
                           Text="Please Wait ..." 
                           TextColor="Black" 
                           FontAttributes="Bold" 
                           VerticalTextAlignment="Center"/>
                </HorizontalStackLayout>
            </Border>
        </Grid>
    </Grid>
</ContentPage>
